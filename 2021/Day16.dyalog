hd←{,⍉2 2 2 2⊤'0123456789ABCDEF'⍳⍵}
parse←{
    8>≢⍵:⍬
    v←2⊥3↑⍵
    t←2⊥3↑3↓⍵
    t=4:(⊂x↓⍨5×n),⍨v,t,2⊥,2⊢/x⍴⍨5,⍨n←1++/∧\x[5×⍳⌊5÷⍨≢x←6↓⍵]
    i←6⊃⍵
    i=0:(⊂l↓22↓⍵),⍨v,t,⊂x⊣(x←⍬){v t d r←parse ⍵ ⋄ x,←⊂v t d ⋄ r}⍣{⍺≡⍬}(22↓⍵)↑⍨l←2⊥15↑7↓⍵
    i=1:v,t,(⊂x),⊂(x←⍬){v t d r←parse ⍵ ⋄ x,←⊂v t d ⋄ r}⍣n⊢18↓⍵⊣n←2⊥11↑7↓⍵
}
{v t d←⍵ ⋄ t=4:v ⋄ (⊃⍵)++/∇¨2⊃⍵} p←3↑parse hd⊃⊃⎕NGET'Day 16.txt'1
{v t d←⍵ ⋄ t=4:d ⋄ (⍎t⊃'+×⌊⌈ ><=')/∇¨d}p
